<!doctype html>
<html>
  <head>
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
    <script src='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css'></script>
    <script src='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js'></script>
    <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery-serialize-object/2.0.0/jquery.serialize-object.compiled.js'></script>
    <script src='http://cdnjs.cloudflare.com/ajax/libs/path.js/0.8.4/path.min.js'></script>
    <script src='index.js'></script>
    <link rel="stylesheet" type="text/css" href="index.css">
  </head>
  <body>
	  <header class="navbar navbar-static-top navbar-inverse" id="top" role="banner">
	    <div class="container">
	        <div class="navbar-header">
	            <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse"> <span class="sr-only">Toggle navigation</span>
	 <span class="icon-bar"></span>
	 <span class="icon-bar"></span>
	 <span class="icon-bar"></span>

	            </button> <a href="#" class="navbar-brand">Firebase login</a>

	        </div>
	        <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
	            <ul class="nav navbar-nav">
	                <li> <a href="#/">Login</a>

	                </li>
	                <li> <a href="#/logout">Logout</a>

	                </li>
	                <li> <a href="#/register">Register</a>

	                </li>
	                <li> <a href="#/profile">Profile</a>

	                </li>
	            </ul>
	        </nav>
	    </div>
	</header>
	<div id="container" class="container">
	    <!-- LOGIN -->
	    <form id="frmLogin" role="form">
	         <h2>Login</h2>

	        <div class="form-group">
	            <label for="txtEmail">Email address</label>
	            <input type="email" class="form-control" id="txtEmail" placeholder="Enter email" name="email" />
	        </div>
	        <div class="form-group">
	            <label for="txtPass">Password</label>
	            <input type="password" class="form-control" id="txtPass" placeholder="Password" name="password" />
	        </div>
	        <button type="submit" class="btn btn-default btn-block">Login</button>
	        <br />
	        <br />
	         <h4>Login with</h4>

	        <a href="#" class="btn btn-danger bt-social" data-provider="google">Google+</a>

	    </form>
	    <!-- / LOGIN -->
	    <!-- LOGOUT -->
	    <form id="frmLogout" role="form">
	         <h2>You are logged out!</h2>

	    </form>
	    <!-- / LOGOUT -->
	    <!-- REGISTER -->
	    <form id="frmRegister" role="form">
	         <h2>Register</h2>

	        <div class="form-group">
	            <label for="txtRegEmail">Email address</label>
	            <input type="email" class="form-control" id="txtEmail" placeholder="Enter email" name="email" />
	        </div>
	        <div class="form-group">
	            <label for="txtRegPass">Password</label>
	            <input type="password" class="form-control" id="txtPass" placeholder="Password" name="password" />
	        </div>
	        <button type="submit" class="btn btn-default">Register</button>
	    </form>
	    <!-- / REGISTER -->
	    <!-- PROFILE -->
	    <form id="frmProfile" role="form">
	         <h2>Profile</h2>

	        <br />
	        <div class="form-group">
	            <label for="txtName">Name</label>
	            <input type="text" class="form-control" id="txtName" placeholder="Name" name="name" />
	        </div>
	        <div class="form-group">
	            <label for="ddlDino">Favorite Dinosaur</label>
	            <select id="ddlDino" name="favoriteDinosaur" class="form-control">
	                <option>None</option>
	                <option>Pteranodon</option>
	                <option>Lambeosaurus</option>
	                <option>Stegosaurus</option>
	                <option>Daspletosaurus</option>
	            </select>
	        </div>
	        <div id='messagesDiv'></div>
    		<input type='text' id='nameInput' placeholder='Name'>
    		<input type='text' id='messageInput' placeholder='Message'>
	        <button type="submit" class="btn btn-primary">Update</button>
	    </form>
	    <!-- / PROFILE -->
	    <hr />
	    <!-- ALERT BOX -->
	    <div id="alert" class="alert" role="alert">
	         <h4 id="alert-title">You are not logged in</h4>

	        <p id="alert-detail"></p>
	    </div>
	    <!-- / ALERT BOX -->
	</div>
    
    <script>
      var myDataRef = new Firebase('https://popping-inferno-1335.firebaseio.com/');
      $('#messageInput').keypress(function (e) {
        if (e.keyCode == 13) {
          mydataRef.authWithOAuthPopup("google", function(error, authData) {
            if (error) {
              console.log("Login Failed!", error);
            } else {
              var name = $('#nameInput').val();
              var text = $('#messageInput').val();
              var d = new Date();
              var curr_date = d.getDate();
              var curr_month = d.getMonth() + 1; //Months are zero based
              var curr_year = d.getFullYear();
              var time = curr_date + "-" + curr_month + "-" + curr_year;
              myDataRef.push({name: name, text: text, time: time});
              $('#messageInput').val('');
            }
          });
        }
      });
      myDataRef.on('child_added', function(snapshot) {
        var message = snapshot.val();
        displayChatMessage(message.name, message.text, message.time);
      });
      function displayChatMessage(name, text, time) {
        $('<div/>').text(text).prepend($('<em/>').text(name+'('+time+'): ')).appendTo($('#messagesDiv'));
        $('#messagesDiv')[0].scrollTop = $('#messagesDiv')[0].scrollHeight;
      }; 
    </script>
  </body>
</html>